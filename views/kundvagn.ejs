<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>scr="Storage.js"</script>
    <title>Document</title>
</head>
<body onload="doShowAll()">
    <form name="ShoppingList">
        <fieldset>
            <legend>Shopping cart</legend>
            <label>Item: <input type="text" name="name"></label>
            <label>Quantity: <input type="text" name="data"></label>
    
            <input type="button" value="Save"   onclick="SaveItem()">
            <input type="button" value="Update" onclick="ModifyItem()">
            <input type="button" value="Delete" onclick="RemoveItem()">
            
        </fieldset>
        <div id="items_table">
            <h2>Shopping List</h2>
            <table id="list"></table>
            <label><input type="button" value="Clear" onclick="ClearAll()">
            * Delete all items</label>
        </div>
    </form>
    <% function doShowAll() {
        if (CheckBrowser()) {
            var key = "";
            var list = "<tr><th>Item</th><th>Value</th></tr>\n";
            var i = 0;
            for (i = 0; i < localStorage.length; i++) {
                key = localStorage.key(i);
                list += "<tr><td>" + key + "</td>\n<td>"
                        + localStorage.getItem(key) + "</td></tr>\n";
            }
            if (list == "<tr><th>Item</th><th>Value</th></tr>\n") {
                list += "<tr><td><i>empty</i></td>\n<td><i>empty</i></td></tr>\n";
            }
            document.getElementById('list').innerHTML = list;
    } else {
        alert('Cannot save shopping list as your browser does not support HTML 5');
    }
} %> 

        <div>
            <input type="button" value="Save"   onclick="SaveItem()">
            <input type="button" value="Update" onclick="ModifyItem()">
            <input type="button" value="Delete" onclick="RemoveItem()">
            <input type="button" value="Clear"  onclick="ClearAll()">
        </div>

        <% 
        function SaveItem() {

var name = document.forms.ShoppingList.name.value;
var data = document.forms.ShoppingList.data.value;
localStorage.setItem(name, data);
doShowAll();
}

//Change an existing key-value in HTML5 storage.
function ModifyItem() {
    var name1 = document.forms.ShoppingList.name.value;
    var data1 = document.forms.ShoppingList.data.value;
    //check if name1 is already exists

//Check if key exists.
            if (localStorage.getItem(name1) !=null)
            {
              //update
              localStorage.setItem(name1,data1);
              document.forms.ShoppingList.data.value = localStorage.getItem(name1);
            }

    doShowAll();
}

function RemoveItem() {
var name=document.forms.ShoppingList.name.value;
document.forms.ShoppingList.data.value=localStorage.removeItem(name);
doShowAll();
}

function ClearAll() {
    localStorage.clear();
    doShowAll();
}

%>


</body>
</html>